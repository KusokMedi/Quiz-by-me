import telebot
from random import choice, shuffle

# –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
bot = telebot.TeleBot('Your_token')

# –°–ª–æ–≤–∞—Ä—å —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏
questions = {
    "–ß—Ç–æ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã–º —Ä–µ—Å—É—Ä—Å–æ–º?": ["–°–æ–ª–Ω–µ—á–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è", "–£–≥–æ–ª—å", "–ù–µ—Ñ—Ç—å", "–ü—Ä–∏—Ä–æ–¥–Ω—ã–π –≥–∞–∑"],
    "–ö–∞–∫–æ–π –≤–∏–¥ —ç–Ω–µ—Ä–≥–∏–∏ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–≥–æ—Ä–∞–Ω–∏–∏ —É–≥–ª—è?": ["–¢–µ–ø–ª–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è", "–°–≤–µ—Ç–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è", "–ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è", "–ó–≤—É–∫–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è"],
    "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –æ—Ç—Ö–æ–¥–æ–≤ —Ä–∞–∑–ª–∞–≥–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ–≥–æ?": ["–ë—É–º–∞–≥–∞", "–ü–ª–∞—Å—Ç–∏–∫", "–ú–µ—Ç–∞–ª–ª", "–°—Ç–µ–∫–ª–æ"],
    "–ö–∞–∫–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞?": ["–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞", "–í—ã—Ä—É–±–∫–∞ –ª–µ—Å–æ–≤", "–°–∂–∏–≥–∞–Ω–∏–µ –º—É—Å–æ—Ä–∞", "–ß–∞—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è"],
    "–ö–∞–∫–∏–µ –ª–∞–º–ø—ã –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏?": ["–°–≤–µ—Ç–æ–¥–∏–æ–¥–Ω—ã–µ –ª–∞–º–ø—ã", "–õ–∞–º–ø—ã –Ω–∞–∫–∞–ª–∏–≤–∞–Ω–∏—è", "–ì–∞–ª–æ–≥–µ–Ω–Ω—ã–µ –ª–∞–º–ø—ã", "–§–ª—É–æ—Ä–µ—Å—Ü–µ–Ω—Ç–Ω—ã–µ –ª–∞–º–ø—ã"],
}

# –°–ª–æ–≤–∞—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
correct_answers = {
    "–ß—Ç–æ –∏–∑ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã–º —Ä–µ—Å—É—Ä—Å–æ–º?": "–°–æ–ª–Ω–µ—á–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è",
    "–ö–∞–∫–æ–π –≤–∏–¥ —ç–Ω–µ—Ä–≥–∏–∏ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–≥–æ—Ä–∞–Ω–∏–∏ —É–≥–ª—è?": "–¢–µ–ø–ª–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è",
    "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –æ—Ç—Ö–æ–¥–æ–≤ —Ä–∞–∑–ª–∞–≥–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ–≥–æ?": "–ë—É–º–∞–≥–∞",
    "–ö–∞–∫–∞—è –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞?": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞",
    "–ö–∞–∫–∏–µ –ª–∞–º–ø—ã –ø–æ—Ç—Ä–µ–±–ª—è—é—Ç –º–µ–Ω—å—à–µ –≤—Å–µ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏?": "–°–≤–µ—Ç–æ–¥–∏–æ–¥–Ω—ã–µ –ª–∞–º–ø—ã",
}

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
user_scores = {}
current_questions = {}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
@bot.message_handler(commands=['start', 'quiz'])
def start_quiz(message):
    user_id = message.from_user.id
    user_scores[user_id] = 0
    current_questions[user_id] = list(questions.keys())
    shuffle(current_questions[user_id])
    bot.send_message(message.chat.id, "–ù–∞—á–Ω–µ–º –≤–∏–∫—Ç–æ—Ä–∏–Ω—É –ø–æ —ç–∫–æ–ª–æ–≥–∏–∏! üßë‚Äçüè´")
    ask_question(message)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–¥–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞
def ask_question(message):
    user_id = message.from_user.id
    if len(current_questions[user_id]) == 0:
        bot.send_message(message.chat.id, f"–í–∏–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ {user_scores[user_id]} –∏–∑ 5 –≤–æ–ø—Ä–æ—Å–æ–≤.")
        return
    question = current_questions[user_id].pop(0)
    options = questions[question]
    markup = telebot.types.ReplyKeyboardMarkup(row_width=2, one_time_keyboard=True)
    markup.add(*options)
    bot.send_message(message.chat.id, f"–í–æ–ø—Ä–æ—Å: {question}", reply_markup=markup)
    bot.register_next_step_handler(message, check_answer, question)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–∞
def check_answer(message, question):
    user_id = message.from_user.id
    if message.text == correct_answers[question]:
        user_scores[user_id] += 1
        bot.send_message(message.chat.id, f"–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üëç –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: {user_scores[user_id]}")
    else:
        bot.send_message(message.chat.id, f"–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ üò¢. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {correct_answers[question]}")
    ask_question(message)  # –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
bot.polling(none_stop=True)
